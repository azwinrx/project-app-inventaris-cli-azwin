
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>cmd: Go Coverage Report</title>
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">project-app-inventaris-cli-azwin/cmd/category.go (0.0%)</option>
				
				<option value="file1">project-app-inventaris-cli-azwin/cmd/categorysub.go (0.0%)</option>
				
				<option value="file2">project-app-inventaris-cli-azwin/cmd/clear_screen.go (0.0%)</option>
				
				<option value="file3">project-app-inventaris-cli-azwin/cmd/home.go (0.0%)</option>
				
				<option value="file4">project-app-inventaris-cli-azwin/cmd/management.go (0.0%)</option>
				
				<option value="file5">project-app-inventaris-cli-azwin/cmd/managementsub.go (0.0%)</option>
				
				<option value="file6">project-app-inventaris-cli-azwin/cmd/reportsub.go (0.0%)</option>
				
				<option value="file7">project-app-inventaris-cli-azwin/database/db.go (0.0%)</option>
				
				<option value="file8">project-app-inventaris-cli-azwin/handler/category.go (47.1%)</option>
				
				<option value="file9">project-app-inventaris-cli-azwin/handler/management.go (60.4%)</option>
				
				<option value="file10">project-app-inventaris-cli-azwin/handler/old.go (100.0%)</option>
				
				<option value="file11">project-app-inventaris-cli-azwin/handler/report.go (100.0%)</option>
				
				<option value="file12">project-app-inventaris-cli-azwin/main.go (0.0%)</option>
				
				<option value="file13">project-app-inventaris-cli-azwin/repository/category.go (89.8%)</option>
				
				<option value="file14">project-app-inventaris-cli-azwin/repository/management.go (87.9%)</option>
				
				<option value="file15">project-app-inventaris-cli-azwin/repository/old.go (100.0%)</option>
				
				<option value="file16">project-app-inventaris-cli-azwin/repository/report.go (100.0%)</option>
				
				<option value="file17">project-app-inventaris-cli-azwin/service/category.go (100.0%)</option>
				
				<option value="file18">project-app-inventaris-cli-azwin/service/management.go (100.0%)</option>
				
				<option value="file19">project-app-inventaris-cli-azwin/service/old.go (100.0%)</option>
				
				<option value="file20">project-app-inventaris-cli-azwin/service/report.go (100.0%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">not covered</span>
				<span class="cov8">covered</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package cmd

import (
        "fmt"
        "os"
        "project-app-inventaris-cli-azwin/handler"
)

func Category(handler handler.HandlerCategory) <span class="cov0" title="0">{
        fmt.Println("\n=== VIEW CATEGORY MENU ===")
                fmt.Println("1. View Categories")
                fmt.Println("2. Add Category")
                fmt.Println("3. View Category Detail")
                fmt.Println("4. Update Category")
                fmt.Println("5. Delete Category")
                fmt.Println("6. Exit")
                fmt.Print("Choose an option: ")
        var choice int
        fmt.Print("Masukkan Menu yang kamu pilih: ")
        fmt.Scanln(&amp;choice)

        switch choice </span>{
        case 1:<span class="cov0" title="0">
                ViewCategory(handler)</span>
        case 2:<span class="cov0" title="0">
                AddCategory(handler)</span>        
        case 3:<span class="cov0" title="0">
                ViewCategoryById(handler)</span>
        case 4:<span class="cov0" title="0">
                UpdateCategory(handler)</span>
        case 5:<span class="cov0" title="0">
                DeleteCategory(handler)</span>
        case 6:<span class="cov0" title="0">
                os.Exit(0)</span>
        default:<span class="cov0" title="0">
                fmt.Println("Pilihan kamu salah tolong masukkan ulang")</span>
        }
}</pre>
		
		<pre class="file" id="file1" style="display: none">package cmd

import (
        "bufio"
        "fmt"
        "os"
        "project-app-inventaris-cli-azwin/handler"
        "strings"
)

func CategorySubmenu(handlerCategory handler.HandlerCategory) <span class="cov0" title="0">{
        for </span><span class="cov0" title="0">{
                fmt.Println("\n=== MENU KATEGORI ===")
                fmt.Println("1. Lihat Semua Kategori")
                fmt.Println("2. Tambah Kategori")
                fmt.Println("3. Lihat Detail Kategori")
                fmt.Println("4. Update Kategori")
                fmt.Println("5. Hapus Kategori")
                fmt.Println("6. Kembali ke Menu Utama")
                fmt.Print("Pilih menu: ")

                var choice int
                _, err := fmt.Scanln(&amp;choice)
                if err != nil </span><span class="cov0" title="0">{
                        fmt.Println("Input tidak valid. Harap masukkan angka.")
                        continue</span>
                }
                
                <span class="cov0" title="0">switch choice </span>{
                case 1:<span class="cov0" title="0">
                        ViewCategory(handlerCategory)</span>
                case 2:<span class="cov0" title="0">
                        AddCategory(handlerCategory)</span>
                case 3:<span class="cov0" title="0">
                        ViewCategoryById(handlerCategory)</span>
                case 4:<span class="cov0" title="0">
                        UpdateCategory(handlerCategory)</span>
                case 5:<span class="cov0" title="0">
                        DeleteCategory(handlerCategory)</span>
                case 6:<span class="cov0" title="0">
                        return</span>
                default:<span class="cov0" title="0">
                        fmt.Println("Pilihan tidak valid. Silakan pilih antara 1 - 6.")</span>
                }
        }
}

func ViewCategory(handler handler.HandlerCategory) <span class="cov0" title="0">{
        fmt.Println("\n=== LIHAT KATEGORI ===")


        handler.GetCategory()

        var choice string
        println("")
        fmt.Print("Apakah kamu ingin melanjutkan ke halaman lain (ya/tidak)? ")
        fmt.Scanln(&amp;choice)

        switch choice </span>{
        case "ya":<span class="cov0" title="0">
                ClearScreen()</span>
        case "tidak":<span class="cov0" title="0">
                os.Exit(0)</span>
        default:<span class="cov0" title="0">
                fmt.Println("Pilihan kamu salah, tolong masukkan ulang")</span>
        }
}

func AddCategory(handler handler.HandlerCategory) <span class="cov0" title="0">{
        reader := bufio.NewReader(os.Stdin)
        fmt.Println("\n=== TAMBAH KATEGORI ===")
        
        // Input category name
        fmt.Print("Nama Kategori: ")
        name, _ := reader.ReadString('\n')
        name = strings.TrimSpace(name)
        
        // Input description
        fmt.Print("Deskripsi: ")
        description, _ := reader.ReadString('\n')
        description = strings.TrimSpace(description)
        
        // Validation
        if name == "" </span><span class="cov0" title="0">{
                fmt.Println("Nama kategori tidak boleh kosong!")
                return
        }</span>
        
        // Call handler to add category
        <span class="cov0" title="0">handler.AddCategory(name, description)</span>
}

func ViewCategoryById(handler handler.HandlerCategory) <span class="cov0" title="0">{
        fmt.Println("\n=== DETAIL KATEGORI ===")
        
        // Input category ID
        var id int
        fmt.Print("Masukkan ID Kategori: ")
        _, err := fmt.Scanln(&amp;id)

        // Validation
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Call handler to get category by id
        <span class="cov0" title="0">handler.GetCategoryById(id)</span>
}

func UpdateCategory(handler handler.HandlerCategory) <span class="cov0" title="0">{
        reader := bufio.NewReader(os.Stdin)
        
        fmt.Println("\n=== UPDATE KATEGORI ===")
        
        var id int
        fmt.Print("Masukkan ID Kategori: ")
        _, err := fmt.Scanln(&amp;id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Input new category name
        <span class="cov0" title="0">fmt.Print("Nama Kategori Baru: ")
        name, _ := reader.ReadString('\n')
        name = strings.TrimSpace(name)
        
        // Input new description
        fmt.Print("Deskripsi Baru: ")
        description, _ := reader.ReadString('\n')
        description = strings.TrimSpace(description)
        
        // Validation
        if name == "" </span><span class="cov0" title="0">{
                fmt.Println("Nama kategori tidak boleh kosong!")
                return
        }</span>
        
        // Call handler to update category
        <span class="cov0" title="0">handler.UpdateCategory(id, name, description)</span>
}

func DeleteCategory(handler handler.HandlerCategory) <span class="cov0" title="0">{
        fmt.Println("\n=== HAPUS KATEGORI ===")
        
        var id int
        fmt.Print("Masukkan ID Kategori yang akan dihapus: ")
        _, err := fmt.Scanln(&amp;id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Confirmation
        <span class="cov0" title="0">var confirm string
        fmt.Print("Apakah Anda yakin ingin menghapus kategori ini? (ya/tidak): ")
        fmt.Scanln(&amp;confirm)
        
        if confirm != "ya" </span><span class="cov0" title="0">{
                fmt.Println("Penghapusan dibatalkan.")
                return
        }</span>
        
        // Call handler to delete category
        <span class="cov0" title="0">handler.DeleteCategory(id)</span>
}
</pre>
		
		<pre class="file" id="file2" style="display: none">package cmd

import (
        "os"
        "os/exec"
        "runtime"
)

func ClearScreen() <span class="cov0" title="0">{
        if runtime.GOOS == "windows" </span><span class="cov0" title="0">{
                cmd := exec.Command("cmd", "/c", "cls")
                cmd.Stdout = os.Stdout
                cmd.Run()
        }</span> else<span class="cov0" title="0"> {
                cmd := exec.Command("clear")
                cmd.Stdout = os.Stdout
                cmd.Run()
        }</span>
}
</pre>
		
		<pre class="file" id="file3" style="display: none">package cmd

import (
        "fmt"
        "os"
        "project-app-inventaris-cli-azwin/handler"
)

func Home(handlerCategory handler.HandlerCategory, handlerManagement handler.HandlerManagement, handlerOld handler.HandlerOld, handlerReport handler.HandlerReport) <span class="cov0" title="0">{
        for </span><span class="cov0" title="0">{
                fmt.Println("\n=== MENU UTAMA ===")
                fmt.Println("1. Fitur Kategori Barang")
                fmt.Println("2. Fitur Manajemen Barang Inventaris")
                fmt.Println("3. Barang yang Perlu Diganti (&gt; 100 hari)")
                fmt.Println("4. Laporan Investasi dan Depresiasi")
                fmt.Println("5. Keluar")
                fmt.Print("Pilih menu: ")

                var choice int
                _, err := fmt.Scanln(&amp;choice)
                if err != nil </span><span class="cov0" title="0">{
                        fmt.Println("Input tidak valid. Harap masukkan angka.")
                        continue</span>
                }
                
                <span class="cov0" title="0">switch choice </span>{
                case 1:<span class="cov0" title="0">
                        CategorySubmenu(handlerCategory)</span>
                case 2:<span class="cov0" title="0">
                        ManagementSubmenu(handlerManagement, handlerCategory)</span>
                case 3:<span class="cov0" title="0">
                        OldItems(handlerOld)</span>
                case 4:<span class="cov0" title="0">
                        ReportSubmenu(handlerReport)</span>
                case 5:<span class="cov0" title="0">
                        fmt.Println("Keluar dari aplikasi...")
                        os.Exit(0)</span>
                default:<span class="cov0" title="0">
                        fmt.Println("Pilihan tidak valid. Silakan pilih antara 1 - 5.")</span>
                }
        }

}
</pre>
		
		<pre class="file" id="file4" style="display: none">package cmd

import (
        "bufio"
        "fmt"
        "os"
        "project-app-inventaris-cli-azwin/handler"
        "strings"
)

func ManagementMenu(handlerManagement handler.HandlerManagement) <span class="cov0" title="0">{
        var choice string

        println("")
        handlerManagement.GetAllItems()
        println("")

        fmt.Print("Apakah kamu ingin melanjutkan ke halaman lain (ya/tidak)? ")
        fmt.Scanln(&amp;choice)

        switch choice </span>{
        case "ya":<span class="cov0" title="0">
                ClearScreen()</span>
        case "tidak":<span class="cov0" title="0">
                os.Exit(0)</span>
        default:<span class="cov0" title="0">
                fmt.Println("Pilihan kamu salah tolong masukkan ulang")</span>
        }
}

func AddItem(handlerManagement handler.HandlerManagement, handlerCategory handler.HandlerCategory) <span class="cov0" title="0">{
        reader := bufio.NewReader(os.Stdin)
        
        fmt.Println("\n=== TAMBAH BARANG INVENTARIS ===")
        
        // Show available categories
        fmt.Println("\nKategori yang Tersedia:")
        handlerCategory.GetCategory()
        
        // Input category ID
        var categoryId int
        fmt.Print("\nID Kategori: ")
        _, err := fmt.Scanln(&amp;categoryId)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Input item name
        <span class="cov0" title="0">fmt.Print("Nama Barang: ")
        name, _ := reader.ReadString('\n')
        name = strings.TrimSpace(name)
        
        // Input price
        var price float64
        fmt.Print("Harga: ")
        _, err = fmt.Scanln(&amp;price)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan harga yang benar.")
                return
        }</span>
        
        // Input purchase date
        <span class="cov0" title="0">fmt.Print("Tanggal Pembelian (YYYY-MM-DD): ")
        purchaseDate, _ := reader.ReadString('\n')
        purchaseDate = strings.TrimSpace(purchaseDate)
        
        // Validation
        if name == "" </span><span class="cov0" title="0">{
                fmt.Println("Nama barang tidak boleh kosong!")
                return
        }</span>
        
        // Call handler to add item
        <span class="cov0" title="0">handlerManagement.AddItem(categoryId, name, price, purchaseDate)</span>
}

func GetItemById(handlerManagement handler.HandlerManagement) <span class="cov0" title="0">{
        fmt.Println("\n=== DETAIL BARANG ===")
        
        var id int
        fmt.Print("Masukkan ID Barang: ")
        _, err := fmt.Scanln(&amp;id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        <span class="cov0" title="0">handlerManagement.GetItemById(id)</span>
}

func UpdateItem(handlerManagement handler.HandlerManagement, handlerCategory handler.HandlerCategory) <span class="cov0" title="0">{
        reader := bufio.NewReader(os.Stdin)
        
        fmt.Println("\n=== UPDATE BARANG ===")
        
        var id int
        fmt.Print("Masukkan ID Barang: ")
        _, err := fmt.Scanln(&amp;id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Show available categories
        <span class="cov0" title="0">fmt.Println("\nKategori yang Tersedia:")
        handlerCategory.GetCategory()
        
        // Input new category ID
        var categoryId int
        fmt.Print("\nID Kategori Baru: ")
        _, err = fmt.Scanln(&amp;categoryId)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Input new item name
        <span class="cov0" title="0">fmt.Print("Nama Barang Baru: ")
        name, _ := reader.ReadString('\n')
        name = strings.TrimSpace(name)
        
        // Input new price
        var price float64
        fmt.Print("Harga Baru: ")
        _, err = fmt.Scanln(&amp;price)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan harga yang benar.")
                return
        }</span>
        
        // Input new purchase date
        <span class="cov0" title="0">fmt.Print("Tanggal Pembelian Baru (YYYY-MM-DD): ")
        purchaseDate, _ := reader.ReadString('\n')
        purchaseDate = strings.TrimSpace(purchaseDate)
        
        // Validation
        if name == "" </span><span class="cov0" title="0">{
                fmt.Println("Nama barang tidak boleh kosong!")
                return
        }</span>
        
        // Call handler to update item
        <span class="cov0" title="0">handlerManagement.UpdateItem(id, categoryId, name, price, purchaseDate)</span>
}

func DeleteItem(handlerManagement handler.HandlerManagement) <span class="cov0" title="0">{
        fmt.Println("\n=== HAPUS BARANG ===")
        
        var id int
        fmt.Print("Masukkan ID Barang yang akan dihapus: ")
        _, err := fmt.Scanln(&amp;id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        // Confirmation
        <span class="cov0" title="0">var confirm string
        fmt.Print("Apakah Anda yakin ingin menghapus barang ini? (ya/tidak): ")
        fmt.Scanln(&amp;confirm)
        
        if confirm != "ya" </span><span class="cov0" title="0">{
                fmt.Println("Penghapusan dibatalkan.")
                return
        }</span>
        
        // Call handler to delete item
        <span class="cov0" title="0">handlerManagement.DeleteItem(id)</span>
}

func OldItems(handlerOld handler.HandlerOld) <span class="cov0" title="0">{
        handlerOld.GetOldItems()
        
        var choice string
        println("")
        fmt.Print("Tekan Enter untuk melanjutkan...")
        fmt.Scanln(&amp;choice)
}</span>

func InvestmentReport(handlerReport handler.HandlerReport) <span class="cov0" title="0">{
        handlerReport.GetInvestmentReport()
        
        var choice string
        println("")
        fmt.Print("Tekan Enter untuk melanjutkan...")
        fmt.Scanln(&amp;choice)
}</span>

func ItemDepreciationReport(handlerReport handler.HandlerReport) <span class="cov0" title="0">{
        fmt.Println("\n=== LAPORAN DEPRESIASI BARANG ===")
        
        var id int
        fmt.Print("Masukkan ID Barang: ")
        _, err := fmt.Scanln(&amp;id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Input tidak valid. Harap masukkan angka.")
                return
        }</span>
        
        <span class="cov0" title="0">handlerReport.GetItemDepreciationReport(id)
        
        var choice string
        println("")
        fmt.Print("Tekan Enter untuk melanjutkan...")
        fmt.Scanln(&amp;choice)</span>
}

func SearchItems(handlerManagement handler.HandlerManagement) <span class="cov0" title="0">{
        reader := bufio.NewReader(os.Stdin)
        
        fmt.Println("\n=== PENCARIAN BARANG ===")
        fmt.Print("Masukkan kata kunci pencarian: ")
        keyword, _ := reader.ReadString('\n')
        keyword = strings.TrimSpace(keyword)
        
        if keyword == "" </span><span class="cov0" title="0">{
                fmt.Println("Kata kunci tidak boleh kosong!")
                return
        }</span>
        
        <span class="cov0" title="0">handlerManagement.SearchItems(keyword)
        
        var choice string
        println("")
        fmt.Print("Tekan Enter untuk melanjutkan...")
        fmt.Scanln(&amp;choice)</span>
}</pre>
		
		<pre class="file" id="file5" style="display: none">package cmd

import (
        "fmt"
        "project-app-inventaris-cli-azwin/handler"
)

func ManagementSubmenu(handlerManagement handler.HandlerManagement, handlerCategory handler.HandlerCategory) <span class="cov0" title="0">{
        for </span><span class="cov0" title="0">{
                fmt.Println("\n=== MENU MANAJEMEN INVENTARIS ===")
                fmt.Println("1. Lihat Semua Barang")
                fmt.Println("2. Tambah Barang")
                fmt.Println("3. Lihat Detail Barang")
                fmt.Println("4. Update Barang")
                fmt.Println("5. Hapus Barang")
                fmt.Println("6. Cari Barang (Berdasarkan Nama)")
                fmt.Println("7. Kembali ke Menu Utama")
                fmt.Print("Pilih menu: ")

                var choice int
                _, err := fmt.Scanln(&amp;choice)
                if err != nil </span><span class="cov0" title="0">{
                        fmt.Println("Input tidak valid. Harap masukkan angka.")
                        continue</span>
                }
                
                <span class="cov0" title="0">switch choice </span>{
                case 1:<span class="cov0" title="0">
                        ManagementMenu(handlerManagement)</span>
                case 2:<span class="cov0" title="0">
                        AddItem(handlerManagement, handlerCategory)</span>
                case 3:<span class="cov0" title="0">
                        GetItemById(handlerManagement)</span>
                case 4:<span class="cov0" title="0">
                        UpdateItem(handlerManagement, handlerCategory)</span>
                case 5:<span class="cov0" title="0">
                        DeleteItem(handlerManagement)</span>
                case 6:<span class="cov0" title="0">
                        SearchItems(handlerManagement)</span>
                case 7:<span class="cov0" title="0">
                        return</span>
                default:<span class="cov0" title="0">
                        fmt.Println("Pilihan tidak valid. Silakan pilih antara 1 - 7.")</span>
                }
        }
}
</pre>
		
		<pre class="file" id="file6" style="display: none">package cmd

import (
        "fmt"
        "project-app-inventaris-cli-azwin/handler"
)

func ReportSubmenu(handlerReport handler.HandlerReport) <span class="cov0" title="0">{
        for </span><span class="cov0" title="0">{
                fmt.Println("\n=== MENU LAPORAN INVESTASI &amp; DEPRESIASI ===")
                fmt.Println("1. Laporan Total Investasi dan Depresiasi")
                fmt.Println("2. Laporan Depresiasi Barang Tertentu")
                fmt.Println("3. Kembali ke Menu Utama")
                fmt.Print("Pilih menu: ")

                var choice int
                _, err := fmt.Scanln(&amp;choice)
                if err != nil </span><span class="cov0" title="0">{
                        fmt.Println("Input tidak valid. Harap masukkan angka.")
                        continue</span>
                }
                
                <span class="cov0" title="0">switch choice </span>{
                case 1:<span class="cov0" title="0">
                        InvestmentReport(handlerReport)</span>
                case 2:<span class="cov0" title="0">
                        ItemDepreciationReport(handlerReport)</span>
                case 3:<span class="cov0" title="0">
                        return</span>
                default:<span class="cov0" title="0">
                        fmt.Println("Pilihan tidak valid. Silakan pilih antara 1 - 3.")</span>
                }
        }
}
</pre>
		
		<pre class="file" id="file7" style="display: none">package database

import (
        "context"

        "github.com/jackc/pgx/v5"
        "github.com/jackc/pgx/v5/pgconn"
)

type PgxIface interface {
        Query(ctx context.Context, sql string, args ...any) (pgx.Rows, error)
        QueryRow(ctx context.Context, sql string, args ...any) pgx.Row
        Exec(ctx context.Context, sql string, args ...any) (pgconn.CommandTag, error)
}

func InitDB() (*pgx.Conn, error) <span class="cov0" title="0">{
        connStr := "user=postgres password=8824001 dbname=db-inventaris sslmode=disable host=localhost"
        conn, err := pgx.Connect(context.Background(), connStr)

        return conn, err
}</span>
</pre>
		
		<pre class="file" id="file8" style="display: none">package handler

import (
        "fmt"
        "os"
        "project-app-inventaris-cli-azwin/service"
        "text/tabwriter"
)

type HandlerCategory struct {
        ServiceCategory service.ServiceCategoryInterface
}

func NewHandlerCategory(serviceCategory service.ServiceCategoryInterface) HandlerCategory <span class="cov8" title="1">{
        return HandlerCategory{
                ServiceCategory: serviceCategory,
        }
}</span>

func (handlerCategory *HandlerCategory) GetCategory() <span class="cov8" title="1">{
        // call service category
        categories, err := handlerCategory.ServiceCategory.GetCategory()
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Failed to retrieve data:", err)
        }</span>

        <span class="cov8" title="1">fmt.Println("\n=== CATEGORIES ===")
        
        w := tabwriter.NewWriter(os.Stdout, 0, 0, 3, ' ', tabwriter.TabIndent)
        fmt.Fprintln(w, "ID\tName\tDescription")
        fmt.Fprintln(w, "--\t----\t-----------")
        
        for _, c := range categories </span><span class="cov8" title="1">{
                fmt.Fprintf(w, "%d\t%s\t%s\n", c.ID, c.Name, c.Description)
        }</span>
        <span class="cov8" title="1">w.Flush()</span>
}

func (handlerCategory *HandlerCategory) AddCategory(name, description string) <span class="cov8" title="1">{
        err := handlerCategory.ServiceCategory.AddCategory(name, description)
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Failed to add category:", err)
                return
        }</span>
        <span class="cov8" title="1">fmt.Println("Category added successfully!")</span>
}

func (handlerCategory *HandlerCategory) GetCategoryById(id int) <span class="cov0" title="0">{
        category, err := handlerCategory.ServiceCategory.GetCategoryById(id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Failed to retrieve category:", err)
                return
        }</span>

        <span class="cov0" title="0">fmt.Println("\n=== CATEGORY DETAIL ===")
        fmt.Printf("ID          : %d\n", category.ID)
        fmt.Printf("Name        : %s\n", category.Name)
        fmt.Printf("Description : %s\n", category.Description)</span>
}

func (handlerCategory *HandlerCategory) UpdateCategory(id int, name, description string) <span class="cov0" title="0">{
        err := handlerCategory.ServiceCategory.UpdateCategory(id, name, description)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Failed to update category:", err)
                return
        }</span>
        <span class="cov0" title="0">fmt.Println("Category updated successfully!")</span>
}

func (handlerCategory *HandlerCategory) DeleteCategory(id int) <span class="cov0" title="0">{
        err := handlerCategory.ServiceCategory.DeleteCategory(id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Failed to delete category:", err)
                return
        }</span>
        <span class="cov0" title="0">fmt.Println("Category deleted successfully!")</span>
}
</pre>
		
		<pre class="file" id="file9" style="display: none">package handler

import (
        "fmt"
        "os"
        "project-app-inventaris-cli-azwin/service"
        "text/tabwriter"
)

type HandlerManagement struct {
        ServiceManagement service.ServiceManagementInterface
}

func NewHandlerManagement(serviceManagement service.ServiceManagementInterface) HandlerManagement <span class="cov8" title="1">{
        return HandlerManagement{
                ServiceManagement: serviceManagement,
        }
}</span>

func (handlerManagement *HandlerManagement) GetAllItems() <span class="cov8" title="1">{
        items, err := handlerManagement.ServiceManagement.GetAllItems()
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Failed to retrieve items:", err)
                return
        }</span>

        <span class="cov8" title="1">fmt.Println("\n=== INVENTORY ITEMS ===")
        
        w := tabwriter.NewWriter(os.Stdout, 0, 0, 3, ' ', tabwriter.TabIndent)
        fmt.Fprintln(w, "ID\tCategory\tName\tPrice\tPurchase Date\tUsage Days")
        fmt.Fprintln(w, "--\t--------\t----\t-----\t-------------\t----------")
        
        for _, item := range items </span><span class="cov8" title="1">{
                fmt.Fprintf(w, "%d\t%s\t%s\tRp %.2f\t%s\t%d days\n", 
                        item.ID, 
                        item.CategoryName, 
                        item.Name, 
                        item.Price, 
                        item.PurchaseDate.Format("2006-01-02"), 
                        item.UsageDays)
        }</span>
        <span class="cov8" title="1">w.Flush()</span>
}

func (handlerManagement *HandlerManagement) AddItem(categoryId int, name string, price float64, purchaseDate string) <span class="cov8" title="1">{
        err := handlerManagement.ServiceManagement.AddItem(categoryId, name, price, purchaseDate)
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Failed to add item:", err)
                return
        }</span>
        <span class="cov8" title="1">fmt.Println("Item added successfully!")</span>
}

func (handlerManagement *HandlerManagement) GetItemById(id int) <span class="cov0" title="0">{
        item, err := handlerManagement.ServiceManagement.GetItemById(id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Failed to retrieve item:", err)
                return
        }</span>

        <span class="cov0" title="0">fmt.Println("\n=== ITEM DETAIL ===")
        fmt.Printf("ID            : %d\n", item.ID)
        fmt.Printf("Category      : %s (ID: %d)\n", item.CategoryName, item.CategoryId)
        fmt.Printf("Name          : %s\n", item.Name)
        fmt.Printf("Price         : Rp%.2f\n", item.Price)
        fmt.Printf("Purchase Date : %s\n", item.PurchaseDate.Format("2006-01-02"))
        fmt.Printf("Usage Days    : %d days\n", item.UsageDays)</span>
}

func (handlerManagement *HandlerManagement) UpdateItem(id int, categoryId int, name string, price float64, purchaseDate string) <span class="cov0" title="0">{
        err := handlerManagement.ServiceManagement.UpdateItem(id, categoryId, name, price, purchaseDate)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Failed to update item:", err)
                return
        }</span>
        <span class="cov0" title="0">fmt.Println("Item updated successfully!")</span>
}

func (handlerManagement *HandlerManagement) DeleteItem(id int) <span class="cov0" title="0">{
        err := handlerManagement.ServiceManagement.DeleteItem(id)
        if err != nil </span><span class="cov0" title="0">{
                fmt.Println("Failed to delete item:", err)
                return
        }</span>
        <span class="cov0" title="0">fmt.Println("Item deleted successfully!")</span>
}
func (handlerManagement *HandlerManagement) SearchItems(keyword string) <span class="cov8" title="1">{
        items, err := handlerManagement.ServiceManagement.SearchItemsByName(keyword)
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Failed to search items:", err)
                return
        }</span>

        <span class="cov8" title="1">if len(items) == 0 </span><span class="cov8" title="1">{
                fmt.Printf("\nNo items found with keyword: '%s'\n", keyword)
                return
        }</span>

        <span class="cov8" title="1">fmt.Printf("\n=== SEARCH RESULTS (keyword: '%s') ===\n", keyword)
        
        w := tabwriter.NewWriter(os.Stdout, 0, 0, 3, ' ', tabwriter.TabIndent)
        fmt.Fprintln(w, "ID\tCategory\tName\tPrice\tPurchase Date\tUsage Days")
        fmt.Fprintln(w, "--\t--------\t----\t-----\t-------------\t----------")
        
        for _, item := range items </span><span class="cov8" title="1">{
                fmt.Fprintf(w, "%d\t%s\t%s\tRp %.2f\t%s\t%d days\n", 
                        item.ID, 
                        item.CategoryName, 
                        item.Name, 
                        item.Price, 
                        item.PurchaseDate.Format("2006-01-02"), 
                        item.UsageDays)
        }</span>
        <span class="cov8" title="1">w.Flush()
        
        fmt.Printf("\nTotal items found: %d\n", len(items))</span>
}</pre>
		
		<pre class="file" id="file10" style="display: none">package handler

import (
        "fmt"
        "project-app-inventaris-cli-azwin/service"
)

type HandlerOld struct {
        ServiceOld service.ServiceOldInterface
}

func NewHandlerOld(serviceOld service.ServiceOldInterface) HandlerOld <span class="cov8" title="1">{
        return HandlerOld{
                ServiceOld: serviceOld,
        }
}</span>

func (handlerOld *HandlerOld) GetOldItems() <span class="cov8" title="1">{
        items, err := handlerOld.ServiceOld.GetOldItems()
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Failed to retrieve old items:", err)
                return
        }</span>

        <span class="cov8" title="1">if len(items) == 0 </span><span class="cov8" title="1">{
                fmt.Println("\n=== NO ITEMS NEED REPLACEMENT ===")
                fmt.Println("All items are still in good condition (less than 100 days old).")
                return
        }</span>

        <span class="cov8" title="1">fmt.Println("\n=== ITEMS THAT NEED REPLACEMENT (&gt; 100 DAYS) ===")
        fmt.Printf("%-5s %-20s %-20s %-15s %-15s %-10s\n", "ID", "Category", "Name", "Price", "Purchase Date", "Usage Days")
        fmt.Println("----------------------------------------------------------------------------------------------------")
        for _, item := range items </span><span class="cov8" title="1">{
                fmt.Printf("%-5d %-20s %-20s Rp%-13.2f %-15s %-10d\n", 
                        item.ID, 
                        item.CategoryName, 
                        item.Name, 
                        item.Price, 
                        item.PurchaseDate.Format("2006-01-02"), 
                        item.UsageDays)
        }</span>
        <span class="cov8" title="1">fmt.Printf("\nTotal items need replacement: %d\n", len(items))</span>
}
</pre>
		
		<pre class="file" id="file11" style="display: none">package handler

import (
        "fmt"
        "math"
        "os"
        "project-app-inventaris-cli-azwin/service"
        "text/tabwriter"
)

type HandlerReport struct {
        ServiceReport service.ServiceReportInterface
}

func NewHandlerReport(serviceReport service.ServiceReportInterface) HandlerReport <span class="cov8" title="1">{
        return HandlerReport{
                ServiceReport: serviceReport,
        }
}</span>

// Calculate depreciation using declining balance method (20% per year)
func calculateDepreciationDisplay(price float64, usageDays int) (float64, float64) <span class="cov8" title="1">{
        years := float64(usageDays) / 365.0
        currentValue := price * math.Pow(0.80, years)
        depreciation := price - currentValue
        return currentValue, depreciation
}</span>

func (handlerReport *HandlerReport) GetInvestmentReport() <span class="cov8" title="1">{
        items, totalInvestment, totalCurrentValue, err := handlerReport.ServiceReport.GetInvestmentReport()
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Gagal mengambil laporan investasi:", err)
                return
        }</span>

        <span class="cov8" title="1">fmt.Println("\n=== LAPORAN INVESTASI DAN DEPRESIASI ===")
        fmt.Println("Metode Depresiasi: Saldo Menurun 20% per tahun")
        
        w := tabwriter.NewWriter(os.Stdout, 0, 0, 3, ' ', tabwriter.TabIndent)
        fmt.Fprintln(w, "ID\tKategori\tNama\tHarga Awal\tHari Pakai\tNilai Saat Ini\tDepresiasi")
        fmt.Fprintln(w, "--\t--------\t----\t----------\t----------\t--------------\t----------")
        
        for _, item := range items </span><span class="cov8" title="1">{
                currentValue, depreciation := calculateDepreciationDisplay(item.Price, item.UsageDays)
                fmt.Fprintf(w, "%d\t%s\t%s\tRp %.2f\t%d\tRp %.2f\tRp %.2f\n", 
                        item.ID, 
                        item.CategoryName, 
                        item.Name, 
                        item.Price,
                        item.UsageDays,
                        currentValue,
                        depreciation)
        }</span>
        <span class="cov8" title="1">w.Flush()
        
        fmt.Println("\n" + string(make([]byte, 100)))
        fmt.Printf("TOTAL INVESTASI AWAL         : Rp%.2f\n", totalInvestment)
        fmt.Printf("TOTAL NILAI SAAT INI         : Rp%.2f\n", totalCurrentValue)
        fmt.Printf("TOTAL DEPRESIASI             : Rp%.2f\n", totalInvestment - totalCurrentValue)
        fmt.Printf("PERSENTASE NILAI TERSISA     : %.2f%%\n", (totalCurrentValue/totalInvestment)*100)</span>
}

func (handlerReport *HandlerReport) GetItemDepreciationReport(id int) <span class="cov8" title="1">{
        item, currentValue, depreciation, err := handlerReport.ServiceReport.GetItemDepreciationReport(id)
        if err != nil </span><span class="cov8" title="1">{
                fmt.Println("Gagal mengambil laporan barang:", err)
                return
        }</span>

        <span class="cov8" title="1">years := float64(item.UsageDays) / 365.0

        fmt.Println("\n=== LAPORAN DEPRESIASI BARANG ===")
        fmt.Printf("ID Barang          : %d\n", item.ID)
        fmt.Printf("Nama Barang        : %s\n", item.Name)
        fmt.Printf("Kategori           : %s\n", item.CategoryName)
        fmt.Printf("Tanggal Pembelian  : %s\n", item.PurchaseDate.Format("2006-01-02"))
        fmt.Printf("Hari Penggunaan    : %d hari (%.2f tahun)\n", item.UsageDays, years)
        fmt.Println("\n--- PERHITUNGAN DEPRESIASI ---")
        fmt.Println("Metode             : Saldo Menurun")
        fmt.Println("Rate Depresiasi    : 20% per tahun")
        fmt.Printf("Harga Awal         : Rp%.2f\n", item.Price)
        fmt.Printf("Nilai Saat Ini     : Rp%.2f\n", currentValue)
        fmt.Printf("Total Depresiasi   : Rp%.2f\n", depreciation)
        fmt.Printf("Persentase Tersisa : %.2f%%\n", (currentValue/item.Price)*100)
        fmt.Println("\nFormula: Nilai = Harga Awal × (0.80)^tahun")
        fmt.Printf("Perhitungan: %.2f × (0.80)^%.2f = %.2f\n", item.Price, years, currentValue)</span>
}
</pre>
		
		<pre class="file" id="file12" style="display: none">package main

import (
        "context"
        "flag"
        "fmt"
        "log"
        "project-app-inventaris-cli-azwin/cmd"
        "project-app-inventaris-cli-azwin/database"
        "project-app-inventaris-cli-azwin/handler"
        "project-app-inventaris-cli-azwin/repository"
        "project-app-inventaris-cli-azwin/service"

        _ "github.com/lib/pq"
)

func main() <span class="cov0" title="0">{
        // Define CLI flags
        listItems := flag.Bool("list", false, "List all inventory items")
        searchItem := flag.String("search", "", "Search items by name (keyword)")
        oldItems := flag.Bool("old", false, "Show items older than 100 days")
        report := flag.Bool("report", false, "Show investment and depreciation report")
        interactive := flag.Bool("interactive", false, "Run in interactive mode")
        
        flag.Parse()

        //init DB connection
        db, err := database.InitDB()

        //check database connection
        if err != nil </span><span class="cov0" title="0">{
                log.Fatal("Failed to connect to the database:", err)
        }</span>else<span class="cov0" title="0">{
                log.Println("Database connection successful")
        }</span>
        
        <span class="cov0" title="0">err = db.Ping(context.Background())
        if err != nil </span><span class="cov0" title="0">{
                log.Fatal("Failed to ping the database:", err)
        }</span>else<span class="cov0" title="0">{
                log.Println("Database ping successful")
        }</span>

        <span class="cov0" title="0">defer db.Close(context.Background())

        //init object
        repoCategory := repository.NewrepoCategory(db)
        serviceCategory := service.NewServiceCategory(&amp;repoCategory)
        handlerCategory := handler.NewHandlerCategory(&amp;serviceCategory)

        repoManagement := repository.NewrepoManagement(db)
        serviceManagement := service.NewServiceManagement(&amp;repoManagement)
        handlerManagement := handler.NewHandlerManagement(&amp;serviceManagement)

        repoOld := repository.NewRepositoryOld(db)
        serviceOld := service.NewServiceOld(&amp;repoOld)
        handlerOld := handler.NewHandlerOld(&amp;serviceOld)

        repoReport := repository.NewRepositoryReport(db)
        serviceReport := service.NewServiceReport(&amp;repoReport)
        handlerReport := handler.NewHandlerReport(&amp;serviceReport)

        // Handle CLI commands
        if *listItems </span><span class="cov0" title="0">{
                handlerManagement.GetAllItems()
                return
        }</span>

        <span class="cov0" title="0">if *searchItem != "" </span><span class="cov0" title="0">{
                handlerManagement.SearchItems(*searchItem)
                return
        }</span>

        <span class="cov0" title="0">if *oldItems </span><span class="cov0" title="0">{
                handlerOld.GetOldItems()
                return
        }</span>

        <span class="cov0" title="0">if *report </span><span class="cov0" title="0">{
                handlerReport.GetInvestmentReport()
                return
        }</span>

        // Default to interactive mode if no flags or -interactive flag is provided
        <span class="cov0" title="0">if *interactive || flag.NFlag() == 0 </span><span class="cov0" title="0">{
                cmd.Home(handlerCategory, handlerManagement, handlerOld, handlerReport)
        }</span> else<span class="cov0" title="0"> {
                fmt.Println("Use -h or --help to see available commands")
        }</span>
}
</pre>
		
		<pre class="file" id="file13" style="display: none">package repository

import (
        "context"
        "errors"
        "fmt"
        "project-app-inventaris-cli-azwin/database"
        "project-app-inventaris-cli-azwin/model"
)

type RepositoryCategoryInterface interface {
        GetCategory() ([]model.Category, error)
        AddCategory(name, description string) error
        GetCategoryById(id int) (model.Category, error)
        UpdateCategory(id int, name, description string) error
        DeleteCategory(id int) error
}

type RepositoryCateogry struct {
        DB database.PgxIface
}

func NewrepoCategory(db database.PgxIface) RepositoryCateogry <span class="cov8" title="1">{
        return RepositoryCateogry{
                DB: db,
        }
}</span>

// Function to see all category
func (repo *RepositoryCateogry) GetCategory() ([]model.Category, error) <span class="cov8" title="1">{
        query := `SELECT id, name, description FROM categories ORDER BY id ASC;`

        rows, err := repo.DB.Query(context.Background(), query)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">defer rows.Close()

        var categories []model.Category
        var category model.Category
        for rows.Next() </span><span class="cov8" title="1">{
                err := rows.Scan(&amp;category.ID, &amp;category.Name, &amp;category.Description)
                if err != nil </span><span class="cov0" title="0">{
                        return nil, err
                }</span>
                <span class="cov8" title="1">categories = append(categories, category)</span>
        }

        <span class="cov8" title="1">return categories, nil</span>
}


// Function to add a new category
func (repo *RepositoryCateogry) AddCategory(name, description string) error <span class="cov8" title="1">{
        // Validasi duplikasi nama kategori
        checkQuery := `SELECT COUNT(*) FROM categories WHERE LOWER(name) = LOWER($1)`
        var count int
        err := repo.DB.QueryRow(context.Background(), checkQuery, name).Scan(&amp;count)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>
        <span class="cov8" title="1">if count &gt; 0 </span><span class="cov8" title="1">{
                return errors.New(fmt.Sprintf("kategori dengan nama '%s' sudah ada", name))
        }</span>

        <span class="cov8" title="1">query := `INSERT INTO categories (name, description, created_at, updated_at) 
                        VALUES ($1, $2, NOW(), NOW())`

        _, err = repo.DB.Exec(context.Background(), query, name, description)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>

        <span class="cov8" title="1">return nil</span>
}

// Function to see category by id
func (repo *RepositoryCateogry) GetCategoryById(id int) (model.Category, error) <span class="cov8" title="1">{
        query := `SELECT id, name, description FROM categories WHERE id = $1`

        var category model.Category
        err := repo.DB.QueryRow(context.Background(), query, id).Scan(&amp;category.ID, &amp;category.Name, &amp;category.Description)
        if err != nil </span><span class="cov8" title="1">{
                return model.Category{}, err
        }</span>

        <span class="cov8" title="1">return category, nil</span>
}

// Function to update category
func (repo *RepositoryCateogry) UpdateCategory(id int, name, description string) error <span class="cov8" title="1">{
        // Validasi duplikasi nama kategori (kecuali ID yang sama)
        checkQuery := `SELECT COUNT(*) FROM categories WHERE LOWER(name) = LOWER($1) AND id != $2`
        var count int
        err := repo.DB.QueryRow(context.Background(), checkQuery, name, id).Scan(&amp;count)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>
        <span class="cov8" title="1">if count &gt; 0 </span><span class="cov8" title="1">{
                return errors.New(fmt.Sprintf("kategori dengan nama '%s' sudah ada", name))
        }</span>

        <span class="cov8" title="1">query := `UPDATE categories SET name = $1, description = $2, updated_at = NOW() WHERE id = $3`

        _, err = repo.DB.Exec(context.Background(), query, name, description, id)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>

        <span class="cov8" title="1">return nil</span>
}

// Function to delete category
func (repo *RepositoryCateogry) DeleteCategory(id int) error <span class="cov8" title="1">{
        query := `DELETE FROM categories WHERE id = $1`

        _, err := repo.DB.Exec(context.Background(), query, id)
        if err != nil </span><span class="cov8" title="1">{
                return err
        }</span>

        <span class="cov8" title="1">return nil</span>
}</pre>
		
		<pre class="file" id="file14" style="display: none">package repository

import (
        "context"
        "errors"
        "fmt"
        "project-app-inventaris-cli-azwin/database"
        "project-app-inventaris-cli-azwin/model"
)

type RepositoryManagementInterface interface {
        GetAllItems() ([]model.Management, error)
        AddItem(categoryId int, name string, price float64, purchaseDate string) error
        GetItemById(id int) (model.Management, error)
        UpdateItem(id int, categoryId int, name string, price float64, purchaseDate string) error
        DeleteItem(id int) error
        SearchItemsByName(keyword string) ([]model.Management, error)
}

type RepositoryManagement struct {
        DB database.PgxIface
}

func NewrepoManagement(db database.PgxIface) RepositoryManagement <span class="cov0" title="0">{
        return RepositoryManagement{
                DB: db,
        }
}</span>

// Function to get all items with category name and usage days
func (repo *RepositoryManagement) GetAllItems() ([]model.Management, error) <span class="cov8" title="1">{
        query := `
                SELECT 
                        i.id, 
                        i.category_id, 
                        c.name as category_name, 
                        i.name, 
                        i.price, 
                        i.purchase_date,
                        CURRENT_DATE - i.purchase_date as usage_days
                FROM items i
                JOIN categories c ON i.category_id = c.id
                ORDER BY i.id ASC`

        rows, err := repo.DB.Query(context.Background(), query)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">defer rows.Close()

        var items []model.Management
        for rows.Next() </span><span class="cov8" title="1">{
                var item model.Management
                err := rows.Scan(
                        &amp;item.ID,
                        &amp;item.CategoryId,
                        &amp;item.CategoryName,
                        &amp;item.Name,
                        &amp;item.Price,
                        &amp;item.PurchaseDate,
                        &amp;item.UsageDays,
                )
                if err != nil </span><span class="cov0" title="0">{
                        return nil, err
                }</span>
                <span class="cov8" title="1">items = append(items, item)</span>
        }

        <span class="cov8" title="1">return items, nil</span>
}

// Function to add a new item
func (repo *RepositoryManagement) AddItem(categoryId int, name string, price float64, purchaseDate string) error <span class="cov8" title="1">{
        // Validasi duplikasi nama barang dalam kategori yang sama
        checkQuery := `SELECT COUNT(*) FROM items WHERE LOWER(name) = LOWER($1) AND category_id = $2`
        var count int
        err := repo.DB.QueryRow(context.Background(), checkQuery, name, categoryId).Scan(&amp;count)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>
        <span class="cov8" title="1">if count &gt; 0 </span><span class="cov0" title="0">{
                return errors.New(fmt.Sprintf("barang dengan nama '%s' sudah ada dalam kategori ini", name))
        }</span>

        // Validasi harga tidak boleh negatif atau nol
        <span class="cov8" title="1">if price &lt;= 0 </span><span class="cov0" title="0">{
                return errors.New("harga barang harus lebih dari 0")
        }</span>

        <span class="cov8" title="1">query := `INSERT INTO items (category_id, name, price, purchase_date, created_at, updated_at) 
                        VALUES ($1, $2, $3, $4, NOW(), NOW())`

        _, err = repo.DB.Exec(context.Background(), query, categoryId, name, price, purchaseDate)
        if err != nil </span><span class="cov8" title="1">{
                return err
        }</span>

        <span class="cov8" title="1">return nil</span>
}

// Function to get item by id
func (repo *RepositoryManagement) GetItemById(id int) (model.Management, error) <span class="cov8" title="1">{
        query := `
                SELECT 
                        i.id, 
                        i.category_id, 
                        c.name as category_name, 
                        i.name, 
                        i.price, 
                        i.purchase_date,
                        CURRENT_DATE - i.purchase_date as usage_days
                FROM items i
                JOIN categories c ON i.category_id = c.id
                WHERE i.id = $1`

        var item model.Management
        err := repo.DB.QueryRow(context.Background(), query, id).Scan(
                &amp;item.ID,
                &amp;item.CategoryId,
                &amp;item.CategoryName,
                &amp;item.Name,
                &amp;item.Price,
                &amp;item.PurchaseDate,
                &amp;item.UsageDays,
        )
        if err != nil </span><span class="cov8" title="1">{
                return model.Management{}, err
        }</span>

        <span class="cov8" title="1">return item, nil</span>
}

// Function to update item
func (repo *RepositoryManagement) UpdateItem(id int, categoryId int, name string, price float64, purchaseDate string) error <span class="cov8" title="1">{
        // Validasi duplikasi nama barang dalam kategori yang sama (kecuali ID yang sama)
        checkQuery := `SELECT COUNT(*) FROM items WHERE LOWER(name) = LOWER($1) AND category_id = $2 AND id != $3`
        var count int
        err := repo.DB.QueryRow(context.Background(), checkQuery, name, categoryId, id).Scan(&amp;count)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>
        <span class="cov8" title="1">if count &gt; 0 </span><span class="cov0" title="0">{
                return errors.New(fmt.Sprintf("barang dengan nama '%s' sudah ada dalam kategori ini", name))
        }</span>

        // Validasi harga tidak boleh negatif atau nol
        <span class="cov8" title="1">if price &lt;= 0 </span><span class="cov0" title="0">{
                return errors.New("harga barang harus lebih dari 0")
        }</span>

        <span class="cov8" title="1">query := `UPDATE items 
                        SET category_id = $1, name = $2, price = $3, purchase_date = $4, updated_at = NOW() 
                        WHERE id = $5`

        _, err = repo.DB.Exec(context.Background(), query, categoryId, name, price, purchaseDate, id)
        if err != nil </span><span class="cov8" title="1">{
                return err
        }</span>

        <span class="cov8" title="1">return nil</span>
}

// Function to delete item
func (repo *RepositoryManagement) DeleteItem(id int) error <span class="cov8" title="1">{
        query := `DELETE FROM items WHERE id = $1`

        _, err := repo.DB.Exec(context.Background(), query, id)
        if err != nil </span><span class="cov8" title="1">{
                return err
        }</span>

        <span class="cov8" title="1">return nil</span>
}

// Function to search items by name keyword
func (repo *RepositoryManagement) SearchItemsByName(keyword string) ([]model.Management, error) <span class="cov8" title="1">{
        query := `
                SELECT 
                        i.id, 
                        i.category_id, 
                        c.name as category_name, 
                        i.name, 
                        i.price, 
                        i.purchase_date,
                        CURRENT_DATE - i.purchase_date as usage_days
                FROM items i
                JOIN categories c ON i.category_id = c.id
                WHERE LOWER(i.name) LIKE LOWER($1)
                ORDER BY i.id ASC`

        rows, err := repo.DB.Query(context.Background(), query, "%"+keyword+"%")
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">defer rows.Close()

        var items []model.Management
        for rows.Next() </span><span class="cov8" title="1">{
                var item model.Management
                err := rows.Scan(
                        &amp;item.ID,
                        &amp;item.CategoryId,
                        &amp;item.CategoryName,
                        &amp;item.Name,
                        &amp;item.Price,
                        &amp;item.PurchaseDate,
                        &amp;item.UsageDays,
                )
                if err != nil </span><span class="cov8" title="1">{
                        return nil, err
                }</span>
                <span class="cov8" title="1">items = append(items, item)</span>
        }

        <span class="cov8" title="1">return items, nil</span>
}

</pre>
		
		<pre class="file" id="file15" style="display: none">package repository

import (
        "context"
        "project-app-inventaris-cli-azwin/database"
        "project-app-inventaris-cli-azwin/model"
)

type RepositoryOldInterface interface {
        GetOldItems() ([]model.Management, error)
}

type RepositoryOld struct {
        DB database.PgxIface
}

func NewRepositoryOld(db database.PgxIface) RepositoryOld <span class="cov8" title="1">{
        return RepositoryOld{
                DB: db,
        }
}</span>

// Function to get items that have been used for more than 100 days
func (repo *RepositoryOld) GetOldItems() ([]model.Management, error) <span class="cov8" title="1">{
        query := `
                SELECT 
                        i.id, 
                        i.category_id, 
                        c.name as category_name, 
                        i.name, 
                        i.price, 
                        i.purchase_date,
                        CURRENT_DATE - i.purchase_date as usage_days
                FROM items i
                JOIN categories c ON i.category_id = c.id
                WHERE CURRENT_DATE - i.purchase_date &gt; 100
                ORDER BY usage_days DESC`

        rows, err := repo.DB.Query(context.Background(), query)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">defer rows.Close()

        var items []model.Management
        for rows.Next() </span><span class="cov8" title="1">{
                var item model.Management
                err := rows.Scan(
                        &amp;item.ID,
                        &amp;item.CategoryId,
                        &amp;item.CategoryName,
                        &amp;item.Name,
                        &amp;item.Price,
                        &amp;item.PurchaseDate,
                        &amp;item.UsageDays,
                )
                if err != nil </span><span class="cov8" title="1">{
                        return nil, err
                }</span>
                <span class="cov8" title="1">items = append(items, item)</span>
        }

        <span class="cov8" title="1">return items, nil</span>
}

</pre>
		
		<pre class="file" id="file16" style="display: none">package repository

import (
        "context"
        "project-app-inventaris-cli-azwin/database"
        "project-app-inventaris-cli-azwin/model"
)

type RepositoryReportInterface interface {
        GetAllItemsForReport() ([]model.Management, error)
        GetItemByIdForReport(id int) (model.Management, error)
}

type RepositoryReport struct {
        DB database.PgxIface
}

func NewRepositoryReport(db database.PgxIface) RepositoryReport <span class="cov8" title="1">{
        return RepositoryReport{
                DB: db,
        }
}</span>

// Function to get all items with usage days for depreciation calculation
func (repo *RepositoryReport) GetAllItemsForReport() ([]model.Management, error) <span class="cov8" title="1">{
        query := `
                SELECT 
                        i.id, 
                        i.category_id, 
                        c.name as category_name, 
                        i.name, 
                        i.price, 
                        i.purchase_date,
                        CURRENT_DATE - i.purchase_date as usage_days
                FROM items i
                JOIN categories c ON i.category_id = c.id
                ORDER BY i.id ASC`

        rows, err := repo.DB.Query(context.Background(), query)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">defer rows.Close()

        var items []model.Management
        for rows.Next() </span><span class="cov8" title="1">{
                var item model.Management
                err := rows.Scan(
                        &amp;item.ID,
                        &amp;item.CategoryId,
                        &amp;item.CategoryName,
                        &amp;item.Name,
                        &amp;item.Price,
                        &amp;item.PurchaseDate,
                        &amp;item.UsageDays,
                )
                if err != nil </span><span class="cov8" title="1">{
                        return nil, err
                }</span>
                <span class="cov8" title="1">items = append(items, item)</span>
        }

        <span class="cov8" title="1">return items, nil</span>
}

// Function to get item by id for depreciation report
func (repo *RepositoryReport) GetItemByIdForReport(id int) (model.Management, error) <span class="cov8" title="1">{
        query := `
                SELECT 
                        i.id, 
                        i.category_id, 
                        c.name as category_name, 
                        i.name, 
                        i.price, 
                        i.purchase_date,
                        CURRENT_DATE - i.purchase_date as usage_days
                FROM items i
                JOIN categories c ON i.category_id = c.id
                WHERE i.id = $1`

        var item model.Management
        err := repo.DB.QueryRow(context.Background(), query, id).Scan(
                &amp;item.ID,
                &amp;item.CategoryId,
                &amp;item.CategoryName,
                &amp;item.Name,
                &amp;item.Price,
                &amp;item.PurchaseDate,
                &amp;item.UsageDays,
        )
        if err != nil </span><span class="cov8" title="1">{
                return model.Management{}, err
        }</span>

        <span class="cov8" title="1">return item, nil</span>
}
</pre>
		
		<pre class="file" id="file17" style="display: none">package service

import (
        "project-app-inventaris-cli-azwin/model"
        "project-app-inventaris-cli-azwin/repository"
)

type ServiceCategoryInterface interface {
        GetCategory() ([]model.Category, error)
        AddCategory(name, description string) error
        GetCategoryById(id int) (model.Category, error)
        UpdateCategory(id int, name, description string) error
        DeleteCategory(id int) error
}

type ServiceCategory struct {
        RepoCategory repository.RepositoryCategoryInterface
}

func NewServiceCategory(repoCategory repository.RepositoryCategoryInterface) ServiceCategory <span class="cov8" title="1">{
        return ServiceCategory{
                RepoCategory: repoCategory,
        }
}</span>

func (serviceCategory *ServiceCategory) GetCategory() ([]model.Category, error) <span class="cov8" title="1">{
        return serviceCategory.RepoCategory.GetCategory()
}</span>

func (serviceCategory *ServiceCategory) AddCategory(name, description string) error <span class="cov8" title="1">{
        return serviceCategory.RepoCategory.AddCategory(name, description)
}</span>

func (serviceCategory *ServiceCategory) GetCategoryById(id int) (model.Category, error) <span class="cov8" title="1">{
        return serviceCategory.RepoCategory.GetCategoryById(id)
}</span>

func (serviceCategory *ServiceCategory) UpdateCategory(id int, name, description string) error <span class="cov8" title="1">{
        return serviceCategory.RepoCategory.UpdateCategory(id, name, description)
}</span>

func (serviceCategory *ServiceCategory) DeleteCategory(id int) error <span class="cov8" title="1">{
        return serviceCategory.RepoCategory.DeleteCategory(id)
}</span>
</pre>
		
		<pre class="file" id="file18" style="display: none">package service

import (
        "project-app-inventaris-cli-azwin/model"
        "project-app-inventaris-cli-azwin/repository"
)

type ServiceManagementInterface interface {
        GetAllItems() ([]model.Management, error)
        AddItem(categoryId int, name string, price float64, purchaseDate string) error
        GetItemById(id int) (model.Management, error)
        UpdateItem(id int, categoryId int, name string, price float64, purchaseDate string) error
        DeleteItem(id int) error
        SearchItemsByName(keyword string) ([]model.Management, error)
}

type ServiceManagement struct {
        RepoManagement repository.RepositoryManagementInterface
}

func NewServiceManagement(repoManagement repository.RepositoryManagementInterface) ServiceManagement <span class="cov8" title="1">{
        return ServiceManagement{
                RepoManagement: repoManagement,
        }
}</span>

func (serviceManagement *ServiceManagement) GetAllItems() ([]model.Management, error) <span class="cov8" title="1">{
        return serviceManagement.RepoManagement.GetAllItems()
}</span>

func (serviceManagement *ServiceManagement) AddItem(categoryId int, name string, price float64, purchaseDate string) error <span class="cov8" title="1">{
        return serviceManagement.RepoManagement.AddItem(categoryId, name, price, purchaseDate)
}</span>

func (serviceManagement *ServiceManagement) GetItemById(id int) (model.Management, error) <span class="cov8" title="1">{
        return serviceManagement.RepoManagement.GetItemById(id)
}</span>

func (serviceManagement *ServiceManagement) UpdateItem(id int, categoryId int, name string, price float64, purchaseDate string) error <span class="cov8" title="1">{
        return serviceManagement.RepoManagement.UpdateItem(id, categoryId, name, price, purchaseDate)
}</span>

func (serviceManagement *ServiceManagement) DeleteItem(id int) error <span class="cov8" title="1">{
        return serviceManagement.RepoManagement.DeleteItem(id)
}</span>
func (serviceManagement *ServiceManagement) SearchItemsByName(keyword string) ([]model.Management, error) <span class="cov8" title="1">{
        return serviceManagement.RepoManagement.SearchItemsByName(keyword)
}</pre>
		
		<pre class="file" id="file19" style="display: none">package service

import (
        "project-app-inventaris-cli-azwin/model"
        "project-app-inventaris-cli-azwin/repository"
)

type ServiceOldInterface interface {
        GetOldItems() ([]model.Management, error)
}

type ServiceOld struct {
        RepoOld repository.RepositoryOldInterface
}

func NewServiceOld(repoOld repository.RepositoryOldInterface) ServiceOld <span class="cov8" title="1">{
        return ServiceOld{
                RepoOld: repoOld,
        }
}</span>

func (serviceOld *ServiceOld) GetOldItems() ([]model.Management, error) <span class="cov8" title="1">{
        return serviceOld.RepoOld.GetOldItems()
}</span>

</pre>
		
		<pre class="file" id="file20" style="display: none">package service

import (
        "math"
        "project-app-inventaris-cli-azwin/model"
        "project-app-inventaris-cli-azwin/repository"
)

type ServiceReportInterface interface {
        GetInvestmentReport() ([]model.Management, float64, float64, error)
        GetItemDepreciationReport(id int) (model.Management, float64, float64, error)
}

type ServiceReport struct {
        RepoReport repository.RepositoryReportInterface
}

func NewServiceReport(repoReport repository.RepositoryReportInterface) ServiceReport <span class="cov8" title="1">{
        return ServiceReport{
                RepoReport: repoReport,
        }
}</span>

// Calculate depreciation using declining balance method (20% per year)
func calculateDepreciation(price float64, usageDays int) float64 <span class="cov8" title="1">{
        // Calculate years (including fractional years)
        years := float64(usageDays) / 365.0
        
        // Declining balance: Current Value = Initial Value × (1 - rate)^years
        // Rate = 20% = 0.20
        currentValue := price * math.Pow(0.80, years)
        
        return currentValue
}</span>

// Get total investment report
func (serviceReport *ServiceReport) GetInvestmentReport() ([]model.Management, float64, float64, error) <span class="cov8" title="1">{
        items, err := serviceReport.RepoReport.GetAllItemsForReport()
        if err != nil </span><span class="cov8" title="1">{
                return nil, 0, 0, err
        }</span>

        <span class="cov8" title="1">var totalInvestment float64
        var totalCurrentValue float64

        for i := range items </span><span class="cov8" title="1">{
                currentValue := calculateDepreciation(items[i].Price, items[i].UsageDays)
                totalInvestment += items[i].Price
                totalCurrentValue += currentValue
        }</span>

        <span class="cov8" title="1">return items, totalInvestment, totalCurrentValue, nil</span>
}

// Get depreciation report for specific item
func (serviceReport *ServiceReport) GetItemDepreciationReport(id int) (model.Management, float64, float64, error) <span class="cov8" title="1">{
        item, err := serviceReport.RepoReport.GetItemByIdForReport(id)
        if err != nil </span><span class="cov8" title="1">{
                return model.Management{}, 0, 0, err
        }</span>

        <span class="cov8" title="1">currentValue := calculateDepreciation(item.Price, item.UsageDays)
        depreciation := item.Price - currentValue

        return item, currentValue, depreciation, nil</span>
}
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
